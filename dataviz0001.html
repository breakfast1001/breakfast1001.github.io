<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2021-01-01" />

<title>Breakfast_0001</title>

<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

/* A workaround for https://github.com/jgm/pandoc/issues/4278 */
a.sourceLine {
  pointer-events: auto;
}

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link rel="stylesheet" href="dataviz0001_files/style.css" type="text/css" />





</head>

<body>




<div id="container">
<div class="inner">
<header>
<h1 class="title toc-ignore">Breakfast_0001</h1>
<h3 class="date">January 1, 2021</h3>
</header>

<hr>



<div id="good-morning-and-welcome-to-my-breakfast-coding-session." class="section level2">
<h2>Good morning and welcome to my breakfast coding session.</h2>
<p>I set out to build a chart that shows the percentage of US population falling under each income bracket.</p>
<p>Inspiration drawn from reading this paper: Dawtry, R. J., Sutton, R. M., &amp; Sibley, C. G. (2015). Why Wealthier People Think People Are Wealthier, and Why It Matters: From Social Sampling to Attitudes to Redistribution. Psychological Science, 26(9), 1389–1400. <a href="https://doi.org/10.1177/0956797615586560" class="uri">https://doi.org/10.1177/0956797615586560</a></p>
<p>My chart today will be based on the format of Figure 1 shown below, so that the chart can help my understanding of the paper.</p>
<p><img src="files/Large_image_Fig1.jpeg" /> Figure 1 Charts a and b above (Dawtry et al., 2015) show 305 participants’ perception of wealth distribution in the United States. Chart (a) showed participants’ estimation of their social circles’ income, and chart (b) showed participants’ estimation of US household incomes.</p>
<p>About the paper: Researchers tested their hypothesis that the higher the participants’ own household incomes, and the higher their perceived household incomes of their social circles, the more likely the participants would assume that society as a whole is wealthier than it actually is.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># An Excel file downloaded from US Census</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># &quot;HINC-01. Selected Characteristics of Households by Total Money Income in 2019&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># https://www.census.gov/data/tables/time-series/demo/income-poverty/cps-hinc/hinc-01.html</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Manually copied and pasted 2 rows of data, and created CSV file. </span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>dat01A &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;files/HINC_01_2019.csv&quot;</span>) </span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># checked on glimpse(), 1 row and 42 columns, need pivot_longer()</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># save Total value for later use </span></span>
<span id="cb1-11"><a href="#cb1-11"></a>Total &lt;-<span class="st"> </span><span class="dv">128451</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>dat01A &lt;-<span class="st"> </span>dat01A <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="st">          </span><span class="kw">pivot_longer</span>(<span class="op">!</span>Total, <span class="dt">names_to =</span> <span class="st">&quot;income&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;count&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="st">          </span><span class="kw">select</span>(<span class="op">-</span>Total) <span class="op">%&gt;%</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">percent =</span> (count<span class="op">/</span>Total)<span class="op">*</span><span class="dv">100</span>, </span>
<span id="cb1-17"><a href="#cb1-17"></a>                 <span class="dt">groupnum =</span> <span class="kw">ceiling</span>(<span class="kw">row_number</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">groupnum_new =</span> <span class="kw">if_else</span>(groupnum <span class="op">&gt;</span><span class="st"> </span><span class="dv">11</span>, </span>
<span id="cb1-19"><a href="#cb1-19"></a>                                        <span class="st">&quot;11&quot;</span>, </span>
<span id="cb1-20"><a href="#cb1-20"></a>                                        <span class="kw">as.character</span>(groupnum<span class="op">*</span><span class="dv">1</span>))) <span class="op">%&gt;%</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">groupnum_new =</span> <span class="kw">as.numeric</span>(groupnum_new))</span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co"># Above: using mutate(), calculate y-axis in percent for x-axis, </span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co"># income brackets are 0 to 15,000 etc, </span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co"># that means each bracket contains 3 rows of dat01,</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co"># using mutate() and based on row_number(), assign a group number for each row</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co"># since x-axis highest income bracket is +$150,000 </span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="co"># while the census data contains many groups above that</span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="co"># everything higher than $150,000 belongs to a single group</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="co"># assigning &quot;11&quot; for everything above $150,000 seems brute force. </span></span>
<span id="cb1-31"><a href="#cb1-31"></a></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="co"># Below: Once we run group_by() the tibble would be unrecognizable</span></span>
<span id="cb1-33"><a href="#cb1-33"></a>dat01A_group &lt;-<span class="st"> </span>dat01A <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="st">                </span><span class="kw">group_by</span>(groupnum_new) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="st">                </span><span class="kw">summarize</span>(<span class="dt">added_bygroup =</span> <span class="kw">sum</span>(percent, <span class="dt">na.rm =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="st">                </span><span class="co"># column names make no sense, rename them</span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="st">                </span><span class="kw">rename</span>(<span class="dt">perc_aggregate =</span> added_bygroup, </span>
<span id="cb1-38"><a href="#cb1-38"></a>                <span class="dt">income_bracket =</span> groupnum_new)</span>
<span id="cb1-39"><a href="#cb1-39"></a></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="co"># Wanted to create a list with the x axis labels, then put directly into ggplot() </span></span>
<span id="cb1-41"><a href="#cb1-41"></a><span class="co"># Ended up not using. </span></span>
<span id="cb1-42"><a href="#cb1-42"></a><span class="co"># tb1 &lt;- tibble(</span></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="co">#            income_bracket = 1:11, </span></span>
<span id="cb1-44"><a href="#cb1-44"></a><span class="co">#            x_labels = c(&quot;0-15&quot;, &quot;15-30&quot;, &quot;30-45&quot;, &quot;45-60&quot;, </span></span>
<span id="cb1-45"><a href="#cb1-45"></a><span class="co">#                               &quot;60-75&quot;, &quot;75-90&quot;, &quot;90-105&quot;, &quot;105-120&quot;, </span></span>
<span id="cb1-46"><a href="#cb1-46"></a><span class="co">#                               &quot;120-135&quot;, &quot;135-150&quot;, &quot;150+&quot;)</span></span>
<span id="cb1-47"><a href="#cb1-47"></a><span class="co">#           ) </span></span>
<span id="cb1-48"><a href="#cb1-48"></a></span>
<span id="cb1-49"><a href="#cb1-49"></a><span class="kw">ggplot</span>(dat01A_group, <span class="kw">aes</span>(<span class="dt">x =</span> income_bracket, <span class="dt">y =</span> perc_aggregate)) <span class="op">+</span></span>
<span id="cb1-50"><a href="#cb1-50"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>, <span class="dt">linetype =</span> <span class="st">&quot;longdash&quot;</span>, <span class="dt">color=</span><span class="st">&quot;#003865&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-51"><a href="#cb1-51"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Income (&#39;000 USD)&quot;</span>,</span>
<span id="cb1-52"><a href="#cb1-52"></a>                   <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>),</span>
<span id="cb1-53"><a href="#cb1-53"></a>                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0-15&quot;</span>,<span class="st">&quot;15-30&quot;</span>, <span class="st">&quot;30-45&quot;</span>, <span class="st">&quot;45-60&quot;</span>, <span class="st">&quot;60-75&quot;</span>, </span>
<span id="cb1-54"><a href="#cb1-54"></a>                              <span class="st">&quot;75-90&quot;</span>, <span class="st">&quot;90-105&quot;</span>, <span class="st">&quot;105-120&quot;</span>, <span class="st">&quot;120-135&quot;</span>, <span class="st">&quot;135-150&quot;</span>, <span class="st">&quot;150+&quot;</span>)</span>
<span id="cb1-55"><a href="#cb1-55"></a>                   ) <span class="op">+</span></span>
<span id="cb1-56"><a href="#cb1-56"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Percentage of Total Households&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-57"><a href="#cb1-57"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Percentage of US Households in Income Brackets, 2019&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-59"><a href="#cb1-59"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">size=</span><span class="dv">16</span>), </span>
<span id="cb1-60"><a href="#cb1-60"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>, <span class="dt">size=</span><span class="dv">12</span>),</span>
<span id="cb1-61"><a href="#cb1-61"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>), </span>
<span id="cb1-62"><a href="#cb1-62"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb1-63"><a href="#cb1-63"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb1-64"><a href="#cb1-64"></a>        <span class="dt">legend.margin =</span> <span class="kw">margin</span>(<span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>))</span></code></pre></div>
<p><img src="dataviz0001_files/figure-html/unnamed-chunk-1-1.png" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># R version 4.0.3</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># ggplot2 version 3.3.2</span></span></code></pre></div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
